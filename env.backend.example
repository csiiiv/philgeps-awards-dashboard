# ==============================================================================
# PhilGEPS Backend Environment Configuration
# ==============================================================================
# For use with: docker-compose.backend.yml
# Copy to .env: cp env.backend.example .env
# ==============================================================================

# ==============================================================================
# Django Configuration
# ==============================================================================

SECRET_KEY=django-insecure-dev-key-CHANGE-IN-PRODUCTION
DEBUG=False

# ==============================================================================
# Network Configuration
# ==============================================================================

# Backend will be accessible at this port
BACKEND_PORT=3200

# Domains allowed to access the backend
# Add your backend domain(s) here (comma-separated, no spaces)
# Note: localhost/127.0.0.1 are automatically included
ALLOWED_HOSTS=philgeps-api.simple-systems.dev,philgeps-api-2.simple-systems.dev

# Frontend domains that can make API requests (include protocol!)
# Add your frontend domain here (comma-separated, no spaces)
# Note: In DEBUG mode, localhost origins are automatically included
CORS_ALLOWED_ORIGINS=https://philgeps.simple-systems.dev,https://philgeps-2.simple-systems.dev

# CSRF trusted origins (same as CORS usually)
# Note: In DEBUG mode, localhost origins are automatically included
CSRF_TRUSTED_ORIGINS=https://philgeps.simple-systems.dev,https://philgeps-2.simple-systems.dev

# ==============================================================================
# Celery & Queue Configuration
# ==============================================================================

# RabbitMQ connection (internal service name)
CELERY_BROKER_URL=amqp://admin:CHANGE-PASSWORD@rabbitmq:5672//

# Redis connection (internal service name)
CELERY_RESULT_BACKEND=redis://redis:6379/0
REDIS_URL=redis://redis:6379/0
REDIS_HOST=redis

# Number of concurrent workers (adjust based on CPU cores)
CELERY_WORKER_CONCURRENCY=4

# ==============================================================================
# RabbitMQ Configuration
# ==============================================================================

RABBITMQ_USER=admin
RABBITMQ_PASSWORD=CHANGE-THIS-PASSWORD

# RabbitMQ ports (external access)
RABBITMQ_PORT=5672
RABBITMQ_MGMT_PORT=15672

# ==============================================================================
# Redis Configuration
# ==============================================================================

REDIS_PORT=6379
REDIS_MAX_MEMORY=512mb

# ==============================================================================
# Flower Monitoring (optional)
# ==============================================================================

FLOWER_PORT=5555

# ==============================================================================
# Application Configuration
# ==============================================================================

# Use RAM disk for parquet data (requires ~3GB RAM)
USE_TMPFS_PARQUET=true

# ==============================================================================
# Gunicorn Configuration
# ==============================================================================

GUNICORN_TIMEOUT=300
GUNICORN_GRACEFUL_TIMEOUT=330
GUNICORN_KEEPALIVE=5
GUNICORN_LOG_LEVEL=info

# ==============================================================================
# Example Production Configuration
# ==============================================================================
#
# Backend deployed at: philgeps-api.simple-systems.dev
# Frontend deployed at: philgeps.simple-systems.dev
#
# SECRET_KEY=<generate-secure-key>
# DEBUG=False
# BACKEND_PORT=3200
# ALLOWED_HOSTS=philgeps-api.simple-systems.dev
# CORS_ALLOWED_ORIGINS=https://philgeps.simple-systems.dev
# CSRF_TRUSTED_ORIGINS=https://philgeps.simple-systems.dev
# RABBITMQ_USER=admin
# RABBITMQ_PASSWORD=<secure-password>
#
# ==============================================================================
# Azure-Specific Configuration (Optional)
# ==============================================================================
#
# If using Azure managed services, replace containerized services:
#
# Azure Redis Cache:
# REDIS_URL=redis://your-redis.redis.cache.windows.net:6380?ssl=true
# CELERY_RESULT_BACKEND=redis://your-redis.redis.cache.windows.net:6380?ssl=true
# (Requires: pip install redis[hiredis] and SSL configuration)
#
# Azure Service Bus (alternative to RabbitMQ):
# CELERY_BROKER_URL=azure-servicebus://connection-string
# (Requires: pip install azure-servicebus and Celery Azure Service Bus transport)
#
# Azure Blob Storage for parquet files:
# AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=...
# (Requires code changes to load parquet from Azure Blob Storage)
#
# ==============================================================================

