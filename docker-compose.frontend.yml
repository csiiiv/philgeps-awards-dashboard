# ==============================================================================
# PhilGEPS Frontend Service - Docker Compose
# ==============================================================================
# Frontend (React + Nginx)
# Deploy this on your frontend cloud service (e.g., Vercel, Netlify, Azure Static Web Apps)
#
# Usage:
#   docker compose -f docker-compose.frontend.yml build
#   docker compose -f docker-compose.frontend.yml up -d
#
# Requirements:
#   - .env file with configuration (see env.frontend.example)
#   - VITE_API_URL must be set to your backend API URL
# ==============================================================================

services:
  # ==============================================================================
  # Frontend (React + Nginx)
  # ==============================================================================
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
      args:
        VITE_API_URL: ${VITE_API_URL:-http://localhost:3200}
    image: philgeps-frontend:latest
    container_name: philgeps-frontend
    ports:
      - "${FRONTEND_PORT:-3000}:80"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:80/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

# ==============================================================================
# Notes:
# ==============================================================================
# 
# 1. IMPORTANT: VITE_API_URL is baked into the build at BUILD TIME
#    You MUST rebuild if you change it:
#    docker compose -f docker-compose.frontend.yml build --no-cache
#
# 2. For production, set VITE_API_URL in .env before building:
#    VITE_API_URL=https://your-backend-api.com
#
# 3. The frontend makes API calls directly to the backend URL specified
#    in VITE_API_URL. Ensure CORS is configured on the backend.
#
# 4. For static hosting (Vercel, Netlify, etc.), you may not need Docker.
#    See DEPLOYMENT_GUIDE.md for platform-specific instructions.
#
# ==============================================================================

